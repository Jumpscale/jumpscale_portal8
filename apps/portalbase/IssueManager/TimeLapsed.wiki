@usedefaults


# use "groupon" to group the issues to form any report
# use extra tags to filter. eg: "priority:critical" or "assignees:despiegk"
{{issue_time_reports groupon:creationTime ranges:4h,2d,4d}}


# this makes sure bootstrap datatables functionality is used
{{datatables_use}}

{% if data_collection is string %}
    ${data_collection}
{% elif data_collection == {} %}
    Nothing to show with applied filters
{% else %}
    {% for data, info in data_collection.items() -%}
        {{accordion:
            - title: ${data}
              label_color: blue
              label_icon: ''
              content: |
                    <div>
                    {% for state, issues in info.items() -%}
                        {% if info[state]|length > 0 %}
                            {% if state in ['closed', 'resolved', 'wontfix'] %}
                                {% set state = "<red style='color:red'> {} </red>".format(state) -%}
                            {% elif state in 'new' %}
                                {% set state = "<green style='color:green'> new </green>" -%}
                            {% else %}
                                {% set state = "<blue style='color:blue'> {} </blue>".format(state) -%}
                            {% endif -%}

                            <h5> <li> ${state} </li> </h3>
                              <table>
                                  <th>Repo</th><th>Title</th><th>Priority</th><th>Last Modified</th>
                                  {% for issue in issues -%}
                                      {% if issue.priority in ['critical'] %}
                                          {% set priority = "<critical style='color:#9e0e23'> CRITICAL </critical>" -%}
                                      {% elif issue.priority in ['major'] %}
                                          {% set priority = "<major style='color:#d87987'> MAJOR </major>" -%}
                                      {% elif issue.priority in ['normal'] %}
                                          {% set priority = "<normal style='color:#3085ad'> NORMAL </normal>" -%}
                                      {% else %}
                                          {% set priority = "<prio style='color:#8b8f91'> {} </prio>".format(issue.priority.upper()) -%}
                                      {% endif -%}
                                      <tr><td>${issue.repo}</td><td><a href="${issue.gitHostRefs[0].url}" target="_blank">${issue.title}</a></td><td>${priority}</td><td>${issue.modTime}</td>
                                {% endfor %}

                             </table>

                        {% endif -%}
                    {% endfor %}
                    </div>
              label_content: '#new ${info.new|length} #resolved ${info.resolved|length} #closed ${info.closed|length} #wontfix ${info.wontfix|length} #inprogress ${info.inprogress|length} #question ${info.question|length}'
              code: False
        }}
    {% endfor %}
{% endif -%}



{{cssstyle
table {
    width: 100%;
}
th, td {
    border: 1px solid black;
    padding: 8px;
}
th {
    background-color: #5d88b3;
    }
    td {
    /*min-width: 100px;*/
    max-width:170px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
}}
