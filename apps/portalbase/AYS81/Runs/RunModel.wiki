@usedefaults

{{timestamp}}

{{aysrun: repo:$$repo runid:$$runid}}

{{cssstyle
    .CodeMirror {
        position: relative;
        left: 15%;
    }
}}

h3. Run $$runid:

*Repo*: [${reponame}|/ays81/repo?repopath=$$repo&repo=${reponame}]
{% if data['state'] in ['error'] %}
    *State*: {{html: <red style='color:red'>ERROR</red> }} [ (Details)|/ays81/action?runid=ays_$$repo&actionkey=${run.actionkey}]
{% elif data['state'] in 'ok' %}
    *State*: {{html: <green style='color:green'>OK</green> }}
{% else %}
    *State*: ${data['state']}
{% endif -%}

*Time*: ${data['lastModDate']}

{{html:
      <script  src='/jslib/codemirror/autorefresh.js' type='text/javascript'></script>
}}

h4. Steps:
{% for step in run.steps -%}
    {{html:
        <div>
           <button type="button" class="btn btn-info" data-toggle="collapse" data-target="#step${step.dbobj.number}">+</button> <b> Step ${step.dbobj.number} (${step.dbobj.state})</b>
          <div id="step${step.dbobj.number}" class="collapse">
     }}
        ** Services:
        {% for service in step.services -%}
            *** [${service.model.dbobj.name}| /ays81/service?aysname=${service.model.dbobj.name}&aysrole=${service.role}&aysrepo=${service.aysrepo.path}]
        {% endfor -%}
        ** Jobs:
        {% for job in step.jobs -%}
            *** Action:
                **** Actor name: ${job.action.dbobj.actorName}
                **** Action name: ${job.action.dbobj.name}
                **** code:
{{code:
${job.action.dbobj.code}
}}
                **** args: ${job.action.dbobj.args}
                **** debug: ${job.action.dbobj.debug}
                **** lastModDate: ${job.action.dbobj.lastModDate}
            *** Logs:
{{code:
${job.printLogs()}
}}
            {% if job.model.dbobj.profileData -%}
                *** [See job cProfile|/ays81/jobprofile?jobid=${job.model.key}]
            {% endif %}
        {% endfor -%}

    {{html:
        </div>
        </div>
        <br>
    }}
{% endfor -%}
